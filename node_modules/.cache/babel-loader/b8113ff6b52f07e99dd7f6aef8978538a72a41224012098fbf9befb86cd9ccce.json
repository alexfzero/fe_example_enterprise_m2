{"ast":null,"code":"import { generateListUidToName } from \"@/helper/uidToName\";\nimport { addGetParameters, loadData } from \"@/helper/requests\";\nexport default {\n  data() {\n    return {\n      search: {\n        value: '',\n        parameter: 'q',\n        in_process: false\n      },\n      options: {\n        sortBy: [],\n        sortDesc: []\n      },\n      pagination: {\n        size_name: 'size',\n        page_name: 'page',\n        need_reload: false,\n        page: 1,\n        count: 0,\n        size: 10,\n        next: false,\n        previous: false,\n        loading: false,\n        current: null,\n        filters: {},\n        footer_page: {\n          'items-per-page-options': [10, 25, 50],\n          'show-current-page': true,\n          'show-first-last-page': true\n        }\n      }\n    };\n  },\n  watch: {\n    'options.sortBy': function (nVal, oVal) {\n      let url = this.getCurrentLoadUrl();\n      if (Object.keys(nVal) !== Object.keys(oVal)) {\n        if (Object.keys(this.options.sortBy).length !== 0) {\n          url = this.getCurrentLoadUrl();\n          let sortParam = null;\n          let sortDesc = null;\n          let sendSort = '';\n          sortParam = Object.assign({}, this.options.sortBy);\n          sortDesc = Object.assign({}, this.options.sortDesc);\n          let countKey = Object.keys(sortParam).length;\n          for (let a in sortDesc) {\n            if (sortDesc[a]) {\n              sortParam[a] = \"-\" + sortParam[a];\n            }\n            countKey--;\n            if (countKey === 0) sendSort = sendSort + sortParam[a];else sendSort = sendSort + sortParam[a] + \",\";\n          }\n          if (url && sendSort.length > 0) {\n            url = this.addGetParameter(this.getCurrentLoadUrl(), 'ordering', sendSort);\n            this.setCurrentLoadUrl(this.addFiltersParameter(url), true);\n          }\n        }\n      }\n    },\n    // eslint-disable-next-line no-unused-vars\n    'pagination.page': function (nVal, oVal) {\n      this.setCurrentLoadUrl(this.addPageParameter(this.getCurrentLoadUrl()));\n    },\n    // eslint-disable-next-line no-unused-vars\n    'pagination.size': function (nVal, oVal) {\n      this.setCurrentLoadUrl(this.addSizeParameter(this.getCurrentLoadUrl()));\n    },\n    'pagination.filters': {\n      deep: true,\n      // eslint-disable-next-line no-unused-vars\n      handler: function (nVal, oVal) {\n        this.cleanPaginationPageData();\n        this.setCurrentLoadUrl(this.addFiltersParameter(this.getCurrentLoadUrl()));\n      }\n    },\n    'pagination.current': function (nVal, oVal) {\n      if (nVal !== oVal && this.pagination.need_reload) this.loadData(this.getCurrentLoadUrl());\n      if (!this.pagination.need_reload) this.pagination.need_reload = true;\n    }\n  },\n  methods: {\n    cleanPaginationPageData() {\n      this.pagination.page = 1;\n      // this.need_reload = false;\n    },\n\n    cleanPaginationData() {\n      this.pagination.size = 10;\n      this.pagination.count = 0;\n      this.pagination.page = 1;\n      // this.need_reload = false;\n    },\n\n    mapResults: function (from, to) {\n      this[to] = from.results;\n      this.mapPagination(from);\n    },\n    mapPagination: function (from) {\n      this.pagination.count = from.count;\n      this.pagination.next = from.next !== null;\n      this.pagination.previous = from.previous !== null;\n    },\n    setCurrentLoadUrl(url) {\n      this.pagination.current = url;\n    },\n    getCurrentLoadUrl() {\n      return this.pagination.current;\n    },\n    loadNames: function (data, uid, fio, finalizer = () => {}) {\n      data.forEach(el => {\n        this.$set(el, fio, \"\");\n      });\n      generateListUidToName(data, uid, fio, finalizer);\n    },\n    setLoading() {\n      this.pagination.loading = true;\n    },\n    setNotLoading() {\n      this.pagination.loading = false;\n    },\n    addSizeParameter(url) {\n      return this.addGetParameter(url, this.pagination.size_name, this.pagination.size);\n    },\n    addPageParameter(url) {\n      return this.addGetParameter(url, this.pagination.page_name, this.pagination.page);\n    },\n    addSearchParameter(url) {\n      return this.addGetParameter(url, this.search.parameter, this.search.value);\n    },\n    addFiltersParameter(url) {\n      return this.addGetParameters(url, this.pagination.filters);\n    },\n    addGetParameters(url, parameters) {\n      return addGetParameters(url, parameters);\n    },\n    addGetParameter(url, key, value) {\n      return addGetParameters(url, {\n        [key]: value\n      });\n    },\n    searchData: function () {\n      this.cleanPaginationPageData();\n      this.setCurrentLoadUrl(this.addSearchParameter(this.getCurrentLoadUrl()));\n    },\n    reloadData: function () {\n      this.clearData();\n      this.loadData(this.getCurrentLoadUrl());\n    },\n    clearData() {},\n    // eslint-disable-next-line no-unused-vars\n    loadData(url = undefined) {}\n  }\n};","map":{"version":3,"names":["generateListUidToName","addGetParameters","loadData","data","search","value","parameter","in_process","options","sortBy","sortDesc","pagination","size_name","page_name","need_reload","page","count","size","next","previous","loading","current","filters","footer_page","watch","nVal","oVal","url","getCurrentLoadUrl","Object","keys","length","sortParam","sendSort","assign","countKey","a","addGetParameter","setCurrentLoadUrl","addFiltersParameter","addPageParameter","addSizeParameter","deep","handler","cleanPaginationPageData","methods","cleanPaginationData","mapResults","from","to","results","mapPagination","loadNames","uid","fio","finalizer","forEach","el","$set","setLoading","setNotLoading","addSearchParameter","parameters","key","searchData","reloadData","clearData","undefined"],"sources":["/home/alex/gitProjects/fe_be_mk_example_enterprise/fe_example_enterprise_m2/src/mixins/PaginatedDataMapperMixin.js"],"sourcesContent":["import {generateListUidToName} from \"@/helper/uidToName\";\nimport {addGetParameters, loadData} from  \"@/helper/requests\";\n\nexport default {\n    data() {\n        return {\n            search: {\n                value: '',\n                parameter: 'q',\n                in_process: false,\n            },\n            options: {\n                sortBy:[],\n                sortDesc:[]\n            },\n            pagination: {\n                size_name: 'size',\n                page_name: 'page',\n                need_reload: false,\n                page: 1,\n                count: 0,\n                size: 10,\n                next: false,\n                previous: false,\n                loading: false,\n                current: null,\n                filters: {},\n                footer_page: {\n                    'items-per-page-options':[10,25,50],\n                    'show-current-page': true,\n                    'show-first-last-page': true\n                }\n            },\n        }\n    },\n    watch: {\n        'options.sortBy': function (nVal, oVal) {\n            let url = this.getCurrentLoadUrl();\n\n            if(Object.keys( nVal) !== Object.keys( oVal)){\n                if(Object.keys( this.options.sortBy).length !== 0 ){\n                    url = this.getCurrentLoadUrl();\n                    let sortParam = null\n                    let sortDesc = null\n                    let sendSort = ''\n\n                    sortParam = Object.assign({},this.options.sortBy)\n                    sortDesc = Object.assign({},this.options.sortDesc)\n\n                    let countKey = Object.keys(sortParam).length\n\n                    for (let a in sortDesc) {\n                        if(sortDesc[a]){\n                            sortParam[a] = \"-\"+sortParam[a]\n                        }\n                        countKey --;\n                        if(countKey === 0)\n                            sendSort = sendSort + sortParam[a]\n                        else\n                            sendSort = sendSort + sortParam[a] + \",\"\n                    }\n\n                    if(url && sendSort.length>0){\n                        url = this.addGetParameter(\n                            this.getCurrentLoadUrl(),\n                            'ordering',\n                            sendSort\n                        )\n\n                        this.setCurrentLoadUrl(\n                            this.addFiltersParameter(\n                                url\n                            ),\n                            true\n                        )\n                    }\n                }\n            }\n        },\n        // eslint-disable-next-line no-unused-vars\n        'pagination.page': function (nVal, oVal) {\n            this.setCurrentLoadUrl(\n                this.addPageParameter(\n                    this.getCurrentLoadUrl()\n                )\n            )\n        },\n        // eslint-disable-next-line no-unused-vars\n        'pagination.size': function (nVal, oVal) {\n            this.setCurrentLoadUrl(\n                this.addSizeParameter(\n                    this.getCurrentLoadUrl()\n                )\n            )\n        },\n        'pagination.filters': {\n            deep: true,\n            // eslint-disable-next-line no-unused-vars\n            handler: function (nVal, oVal) {\n                this.cleanPaginationPageData();\n                this.setCurrentLoadUrl(\n                    this.addFiltersParameter(\n                        this.getCurrentLoadUrl()\n                    )\n                )\n            }\n        },\n        'pagination.current': function (nVal, oVal) {\n            if(nVal !== oVal && this.pagination.need_reload)\n                this.loadData(\n                    this.getCurrentLoadUrl()\n                )\n            if(!this.pagination.need_reload)\n                this.pagination.need_reload = true;\n        }\n\n    },\n    methods: {\n        cleanPaginationPageData(){\n            this.pagination.page = 1;\n            // this.need_reload = false;\n        },\n        cleanPaginationData(){\n            this.pagination.size = 10;\n            this.pagination.count = 0;\n            this.pagination.page = 1;\n            // this.need_reload = false;\n        },\n        mapResults: function (from, to) {\n            this[to] = from.results;\n            this.mapPagination(from);\n        },\n        mapPagination: function (from) {\n            this.pagination.count = from.count;\n            this.pagination.next = from.next !== null;\n            this.pagination.previous = from.previous !== null;\n        },\n        setCurrentLoadUrl(url){\n            this.pagination.current = url;\n        },\n        getCurrentLoadUrl(){\n            return this.pagination.current;\n        },\n        loadNames: function (data, uid, fio, finalizer=()=>{}) {\n            data.forEach(el => {\n                this.$set(el, fio, \"\")\n            });\n            generateListUidToName(data, uid, fio, finalizer)\n        },\n        setLoading(){\n            this.pagination.loading = true;\n        },\n        setNotLoading(){\n            this.pagination.loading = false;\n        },\n        addSizeParameter(url){\n            return this.addGetParameter(\n                url,\n                this.pagination.size_name,\n                this.pagination.size,\n            )\n        },\n        addPageParameter(url){\n            return this.addGetParameter(\n                url,\n                this.pagination.page_name,\n                this.pagination.page\n            )\n        },\n        addSearchParameter(url) {\n            return this.addGetParameter(\n                url,\n                this.search.parameter,\n                this.search.value\n            )\n        },\n        addFiltersParameter(url) {\n            return this.addGetParameters(\n                url,\n                this.pagination.filters\n            )\n        },\n        addGetParameters(url, parameters){\n            return addGetParameters(url, parameters)\n        },\n        addGetParameter(url, key, value){\n            return addGetParameters(url, {\n                [key]: value,\n            })\n        },\n        searchData: function () {\n            this.cleanPaginationPageData();\n            this.setCurrentLoadUrl(\n                this.addSearchParameter(\n                    this.getCurrentLoadUrl()\n                )\n            )\n        },\n        reloadData: function(){\n            this.clearData();\n            this.loadData(this.getCurrentLoadUrl());\n        },\n        clearData(){},\n        // eslint-disable-next-line no-unused-vars\n        loadData(url=undefined) {},\n    },\n\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}